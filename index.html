<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wordle Deutsch</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#121213">

<style>
body {
    font-family: Arial, sans-serif;
    text-align: center;
    background: #121213;
    color: white;
}
.grid {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 5px;
    max-width: 300px;
    margin: 20px auto;
}
.cell {
    border: 2px solid #3a3a3c;
    height: 55px;
    font-size: 28px;
    font-weight: bold;
    display: flex;
    align-items: center;
    justify-content: center;
}
.correct { background: #538d4e; }
.present { background: #b59f3b; }
.absent  { background: #3a3a3c; }
</style>
</head>
<body>

<h1>Wordle üá©üá™</h1>
<div id="grid" class="grid"></div>

<input id="guess" maxlength="5">
<button onclick="submitGuess()">OK</button>
<p id="msg"></p>

<script>
if ("serviceWorker" in navigator) navigator.serviceWorker.register("service-worker.js");

let words = [];
let solution = "";
let row = 0;
const max = 6;
const grid = document.getElementById("grid");

for (let i = 0; i < max * 5; i++) {
    const c = document.createElement("div");
    c.className = "cell";
    grid.appendChild(c);
}

// W√∂rter laden
fetch("woerter.txt").then(r => r.text()).then(t => {
    words = t.split("\n").map(w => w.trim());
    solution = words[Math.floor(Math.random() * words.length)];
});

function submitGuess() {
    const guessInput = document.getElementById("guess");
    const guess = guessInput.value.toLowerCase();

    if (guess.length !== 5) return;

    const start = row * 5;
    const solutionArray = solution.split('');
    const guessArray = guess.split('');

    // Ergebnisfarben vorbereiten
    const colors = ["absent","absent","absent","absent","absent"];
    const solutionUsed = [false,false,false,false,false];

    // 1Ô∏è‚É£ Gr√ºn pr√ºfen (richtige Position)
    for (let i = 0; i < 5; i++) {
        if (guessArray[i] === solutionArray[i]) {
            colors[i] = "correct";
            solutionUsed[i] = true;
        }
    }

    // 2Ô∏è‚É£ Gelb pr√ºfen (falsche Position)
    for (let i = 0; i < 5; i++) {
        if (colors[i] === "correct") continue;
        for (let j = 0; j < 5; j++) {
            if (!solutionUsed[j] && guessArray[i] === solutionArray[j]) {
                colors[i] = "present";
                solutionUsed[j] = true;
                break;
            }
        }
    }

    // 3Ô∏è‚É£ Zellen einf√§rben
    for (let i = 0; i < 5; i++) {
        const c = grid.children[start + i];
        c.textContent = guessArray[i].toUpperCase();
        c.className = "cell " + colors[i];
    }

    // 4Ô∏è‚É£ Gewinn pr√ºfen
    if (guess === solution) {
        document.getElementById("msg").textContent = "üéâ Gewonnen!";
        guessInput.disabled = true;
        return;
    }

    row++;
    guessInput.value = "";

    // 5Ô∏è‚É£ Verlust pr√ºfen
    if (row >= max) {
        document.getElementById("msg").textContent = "üò¢ Verloren! Wort war: " + solution.toUpperCase();
        guessInput.disabled = true;
    }
}
</script>
</body>
</html>
